"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));

var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));

var _ = require('lodash');

var ApimapFieldsFormater = /*#__PURE__*/function () {
  function ApimapFieldsFormater(_ref) {
    var logger = _ref.logger;
    (0, _classCallCheck2["default"])(this, ApimapFieldsFormater);
    this.logger = logger;
  }

  (0, _createClass2["default"])(ApimapFieldsFormater, [{
    key: "formatFieldsByCollectionName",
    value: function formatFieldsByCollectionName(fields, collectionName) {
      var _this = this;

      var fieldsValid = _.filter(fields, function (field) {
        if (_.isUndefined(field.field) || _.isNull(field.field)) {
          _this.logger.warn("Bad Smart Field declaration in \"".concat(collectionName, "\" collection: missing \"field\" attribute."));

          return false;
        }

        return true;
      });

      return _.map(fieldsValid, function (field) {
        field.isVirtual = true;
        field.isFilterable = field.isFilterable || false;
        field.isSortable = field.isSortable || false;
        field.isReadOnly = !field.set;
        return field;
      });
    }
  }]);
  return ApimapFieldsFormater;
}();

module.exports = ApimapFieldsFormater;